
<!DOCTYPE HTML>
<html>
<head>
  <title>black_white - another page</title>
  <meta name="description" content="website description" />
  <meta name="keywords" content="website keywords, website keywords" />
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <link rel="stylesheet" type="text/css" href="./style/style.css" title="style" />
  <script defer src='https://portalstage.catchpoint.com/jp/93824/latest/InitialLoadScript.js'></script>
  <!---The following code changes the beacon from unload/beforeunload to pageHide -->
  <script language="javascript" type="text/javascript">
    if (window.RProfiler) {
      window.RProfiler.usePageHide();
    } else {
      window.addEventListener('GlimpseLoaded', () => window.RProfiler.usePageHide());
    }
  </script>
  <!-- <script type="application/javascript" src="rprofiler.js"></script> -->
  <script language="javascript" type="text/javascript">
    function init() {
      window.RProfiler.excludeBenchMarks();
    }
    window.RProfiler ? init() : window.addEventListener("GlimpseLoaded", init);
  </script>
</head>
<body>
  <div id="main">
    <div id="header">
      <div id="logo">
        <div id="logo_text">
          <!-- class="logo_colour", allows you to change the colour of the text -->
          <h1><a href="./index.html">black<span class="logo_colour">_white</span></a></h1>
          <h2>Simple. Contemporary. Website Template.</h2>
        </div>
      </div>
      <div id="menubar">
        <ul id="menu">
          <!-- put class="selected" in the li tag for the selected page - to highlight which page you're on -->
          <li><a href="./index.html">Home</a></li>
          <li><a href="./examples.html">Examples</a></li>
          <li><a href="./page.html">A Page</a></li>
          <li class="selected"><a href="./another_page.html">Another Page</a></li>
          <li><a href="./contact.html">Contact Us</a></li>
        </ul>
      </div>
    </div>
    <div id="site_content">
      <div class="sidebar">
        <!-- insert your sidebar items here -->
        <h3>Latest News</h3>
        <h4>New Website Launched</h4>
        <h5>July 1st, 2014</h5>
        <p>2014 sees the redesign of our website. Take a look around and let us know what you think.<br /><a href="#">Read more</a></p>
        <p></p>
        <h4>New Website Launched</h4>
        <h5>July 1st, 2014</h5>
        <p>2014 sees the redesign of our website. Take a look around and let us know what you think.<br /><a href="#">Read more</a></p>
        <h3>Useful Links</h3>
        <ul>
          <li><a href="#">link 1</a></li>
          <li><a href="#">link 2</a></li>
          <li><a href="#">link 3</a></li>
          <li><a href="#">link 4</a></li>
        </ul>
        <h3>Search</h3>
        <form method="post" action="#" id="search_form">
          <p>
            <input class="search" type="text" name="search_field" value="Enter keywords....." />
            <input name="search" type="image" style="border: 0; margin: 0 0 -9px 5px;" src="/jsptest/style/search.png" alt="Search" title="Search" />
          </p>
        </form>
      </div>
      <div id="content">
        <button id="button">Make Ajax call</button>
        <br />
        <button id="button1">JS error</button>
        <br />
        <button id="button2">Promise error</button>
        <!-- insert the page content here -->
        <h1>Another Page</h1>
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui.</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui.</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui.</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui.</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui.</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui.</p>
      </div>
    </div>
    <div id="footer">
      Copyright Â© black_white \
      <a href="http://validator.w3.org/check?uri=referer">HTML5</a> \
      <a href="http://jigsaw.w3.org/css-validator/check/referer">CSS</a> \
      <a href="http://www.html5webtemplates.co.uk">Free CSS Templates</a>
    </div>
  </div>

  <!-- ========= NS Degrader Injection (JS-only, no SW) ========= -->
  <script>
  (function () {
    // ---- Runtime controls via query params ----
    // ?nsdev=on&loss=0.35&delay=800&jitter=300&match=%5E%2Fping%5C.txt$&paths=(benchmark|lastmile|another_page\\.html)
    const q = new URLSearchParams(location.search);
    const ENABLED = (q.get('nsdev') || 'on') === 'on';
    const LOSS = Math.max(0, Math.min(1, parseFloat(q.get('loss') || '0.25')));     // 25% failures
    const DELAY = parseInt(q.get('delay') || '600', 10);                            // base delay (ms)
    const JITTER = parseInt(q.get('jitter') || '250', 10);                          // +/- jitter (ms)
    const MATCH = new RegExp(q.get('match') || '^/ping\\.txt$');                    // which paths to degrade
    const PATH_FILTER = new RegExp(q.get('paths') || '(benchmark|lastmile|another_page\\.html)'); // where to run

    if (!ENABLED || !PATH_FILTER.test(location.pathname)) {
      console.log('[NSDEV] disabled on this path or via params.');
      return;
    }

    function sleep(ms) { return new Promise(r => setTimeout(r, ms)); }

    function shouldDegrade(urlLike) {
      try {
        const u = new URL(typeof urlLike === 'string' ? urlLike : urlLike.url || '', location.origin);
        if (u.origin !== location.origin) return false;           // only same-origin
        return MATCH.test(u.pathname);
      } catch (e) {
        return false;
      }
    }

    // ---- fetch() monkeypatch ----
    const _fetch = window.fetch.bind(window);
    window.fetch = async function(input, init = {}) {
      const urlStr = (typeof input === 'string') ? input : (input && input.url) || '';
      if (shouldDegrade(urlStr)) {
        const jitter = (Math.random() * 2 - 1) * JITTER;
        const wait = Math.max(0, DELAY + jitter);
        await sleep(wait);
        if (Math.random() < LOSS) {
          // Non-OK response so your measurement counts it as a failure
          return new Response('Simulated network failure', { status: 599, statusText: 'NSDEV_FAIL' });
        }
      }
      // Prevent cache skew affecting RTT
      const merged = Object.assign({ cache: 'no-store', credentials: 'same-origin' }, init || {});
      return _fetch(input, merged);
    };

    // ---- XMLHttpRequest monkeypatch (covers libraries using XHR) ----
    const _open = XMLHttpRequest.prototype.open;
    const _send = XMLHttpRequest.prototype.send;
    XMLHttpRequest.prototype.open = function(method, url) {
      this.__nsdevUrl = url;
      return _open.apply(this, arguments);
    };
    XMLHttpRequest.prototype.send = function(body) {
      if (shouldDegrade(this.__nsdevUrl)) {
        const xhr = this;
        const jitter = (Math.random() * 2 - 1) * JITTER;
        const wait = Math.max(0, DELAY + jitter);
        const willFail = Math.random() < LOSS;
        setTimeout(function() {
          if (willFail) {
            try { xhr.abort(); } catch (e) {}
          } else {
            _send.call(xhr, body);
          }
        }, wait);
        return; // Defer actual send or abort after delay
      }
      return _send.call(this, body);
    };

    console.log('[NSDEV] enabled. match=', MATCH, 'loss=', LOSS, 'delay=', DELAY, 'jitter=', JITTER);
  })();
  </script>
  <!-- ========= /NS Degrader Injection ========= -->

  <script type="application/javascript" src="main.js"></script>
</body>
</html>
``
